<!doctype html>
<html>
	<head>
		<meta charset="utf-8" />
		<title>Combat</title>
		<style>
			html, body {
				width: 100%;
				height: 100%;
			}

			body {
				background-color: #ffffff;
				margin: 0;
				overflow: hidden;
				font-family: arial;
			}
			
			#outercircle {
				position: absolute;
				margin: auto;
				top:0;
				bottom: 0;
				left: 0;
				right: 0;
				border-radius: 50%;
				background:#FFF;
				width: 4px;
				height: 4px; 
				visibility:hidden;
			}
			
			#innercircle { 
				position: absolute;
				margin: auto;
				top:0;
				bottom: 0;
				left: 0;
				right: 0;
				border-radius: 50%;
				background:#000;
				width: 2px;
				height: 2px; 
				visibility:hidden;
			}
			
			#splash {

				width: 100%;
				height: 100%;
				
				display: -webkit-box;
                display: -moz-box;
                display: box;

                -webkit-box-orient: horizontal;
                -moz-box-orient: horizontal;
                box-orient: horizontal;

                -webkit-box-pack: center;
                -moz-box-pack: center;
                box-pack: center;

                -webkit-box-align: center;
                -moz-box-align: center;
                box-align: center;

                color: #ffffff;
                text-align: center;

				color: #ffffff;
				background:#000;
				text-align: center;
			}
			
		</style>
	</head>
	<body>
		
		<div id="splash" style="font-size:60px">
			Get Ready: 
			<div id="time" >
			</div>
		</div>

		<div id="outercircle">
			<div id="innercircle">
			</div>
		</div>
		
	</body>

	
	<script id="fragment_shader2" type="x-shader/x-fragment">
	uniform float redWeight;
	uniform float blueWeight;
	uniform float greenWeight;
	
	uniform vec2 resolution;

	varying vec2 vUv;

	void main( void ) {

		vec2 position = vUv;
		float red = redWeight;
		float blue = blueWeight;
		float green = greenWeight;
		
		if ( (position.x > 0.99 || position.x < 0.01) || (position.y < 0.01 ||  position.y > 0.99) ) {
			red = 0.0;
			blue = 0.0;
			green = 0.0;
		}
		gl_FragColor = vec4( red, green, blue, 1.0 );
	}

	</script>
	
	<script id="ground_shader" type="x-shader/x-fragment">
	uniform vec2 resolution;

	varying vec2 vUv;

	void main( void ) {
		vec2 position = vUv;
		
		float red;
		float blue;
		float green;

		if ( mod(position.x*100.0, 10.0) < 3.0 || mod(position.y*100.0, 10.0) < 3.0) {
			red = sin(position.x);
			blue = sin(position.x);
			green = sin(position.x);
		}
		else {
			red = cos(position.y);
			blue = cos(position.y);
			green = cos(position.y);
		}
		gl_FragColor = vec4( red, green, blue, 1.0 );
	}

	</script>
	

	<script id="vertexShader" type="x-shader/x-vertex">
		varying vec2 vUv;

		void main()
		{
			vUv = uv;
			vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );
			gl_Position = projectionMatrix * mvPosition;
		}

	</script>
	
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.5.1/jquery.min.js"></script>
	<script src="js/three.js"></script>
	<script src="js/cannon.js"></script>
	<script src="/socket.io/socket.io.js"></script>
	<script src="js/seedrandom.js"></script>
	<script src="js/stats.min.js"></script>
	<script src="js/ColorConverter.js"></script>
	
	<script src="js/shaders/CopyShader.js"></script>
	<script src="js/shaders/FXAAShader.js"></script>
	<script src="js/postprocessing/EffectComposer.js"></script>
	<script src="js/postprocessing/RenderPass.js"></script>
	<script src="js/postprocessing/ShaderPass.js"></script>
	<script src="js/postprocessing/MaskPass.js"></script>
	
	<script src="js/PointerLockControls.js"></script>
	<script src="js/Network.js"></script>
	<script src="js/Game.js"></script>
	<script src="js/Interface.js"></script>
	<script src="js/Player.js"></script>
	<script src="js/Utils.js"></script>
	
	
	<audio autoplay loop id="background_music">
		<source src="assets/angrymob.mp3">
	</audio>
	
	
	<script>
		var startTime = 3.0
		var count=0;
		var volume = 0;
		$("#background_music").get(0).volume = 0
		var timer = setInterval( counter, 100);
		var fade_music;
		
		function counter() {
			count++;
			if (count >= 30) {
				clearInterval(timer);
				$('#innercircle').css('visibility', 'visible')
				$('#outercircle').css('visibility', 'visible')
				$('#splash').remove();
				fade_music= setInterval( fade, 100);
				init();
			}
			$("#time").html( parseFloat(Math.round((startTime - count*0.1)*10 )/10).toFixed(1));
		}
		
		
		function fade() {
			volume += 0.01;
			$("#background_music").get(0).volume = volume;
			if (volume >= 1.0)
				clearInterval(fade_music);
		}
		
		function init() {
			Network.setup();
			Interface.setup();
			Game.setupPhysics();
			Game.setupRender();
			
			Game.begin();
		}
	</script>
</html>